<!DOCTYPE html><html><head><link rel="icon" href="/favicon.ico"/><link rel="preload" href="//at.alicdn.com/t/font_2533274_yhzuq4j0hfr.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="stylesheet" href="//at.alicdn.com/t/font_2533274_yhzuq4j0hfr.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1DXREC8Y53"></script><script>
              window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments)}
              gtag('js', new Date()); gtag('config', 'G-1DXREC8Y53');
            </script><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="keywords" content="yrobot,blog,博客,DOM,操作"/><meta name="description" content="DOM操作"/><title>DOM操作</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/886f8c3411ad1c39be9a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/886f8c3411ad1c39be9a.css" data-n-g=""/><link rel="preload" href="/_next/static/css/5ac94e1cddf3a5717d52.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5ac94e1cddf3a5717d52.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-ea0a66d28b40ad4ab0d2.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-d3984ef788efc6bd8157.js" as="script"/><link rel="preload" href="/_next/static/chunks/597-9d03ea954e499bbdd7af.js" as="script"/><link rel="preload" href="/_next/static/chunks/778-1467ee0b708f5cd375c0.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-9ca82ec4d4aca520c43d.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-49d413833563c7b39a6e.js" as="script"/><link rel="preload" href="/_next/static/chunks/525-eaa095b223f3548a6266.js" as="script"/><link rel="preload" href="/_next/static/chunks/644-2d382948659572c3e3d0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B...path%5D-53df0732a14e01452fa5.js" as="script"/></head><body><div id="__next"><div class="mx-auto md:max-w-screen-lg 2xl:max-w-screen-2xl"><div class="md:flex flex-row items-start justify-between"><div class="card menu h-60px md:flex-none md:w-90px md:h-600px md:mr-20px 2xl:w-120px 2xl:h-850px 2xl: 2xl:mr-50px flex flex-row items-center justify-between md:flex-col mb-20px"><a class="iconfont iconlogo flex-none mr-auto ml-15px md:ml-0 md:mr-0 md:mt-20px md:mb-auto w-30px h-30px text-30px md:w-50px md:h-50px md:text-50px 2xl:w-60px 2xl:h-60px 2xl:text-60px"></a><a class="iconfont iconhome cursor-pointer flex-none w-20px h-20px text-20px mr-20px md:mr-0 md:mb-50px md:w-30px md:h-30px md:text-30px" href="/"></a><a class="iconfont icongithub cursor-pointer flex-none w-20px h-20px text-20px mr-20px md:mr-0 md:mb-50px md:w-30px md:h-30px md:text-30px" target="_blank" href="https://github.com/Yrobot"></a><a class="iconfont iconemail cursor-pointer flex-none w-20px h-20px text-20px  mr-20px md:mr-0 md:mb-50px md:w-30px md:h-30px md:text-30px" href="mailto:y_robot@yeah.net?subject="></a><a class="iconfont cursor-pointer flex-none w-20px h-20px text-20px mr-15px md:mr-0 md:mb-20px 2xl:mb-50px md:w-30px md:h-30px md:text-30px iconenglish"></a></div><div class="min-w-0 flex-auto 2xl:flex flex-row items-start justify-between"><div class="min-w-0 2xl:flex-auto 2xl:mr-50px 2xl:pt-30px"><div class="text-center text-xl mb-6px md:text-4xl md:font-bold md:mb-10px 2xl:text-5xl 2xl:mb-15px font-medium">DOM操作</div><div class="text-center whitespace-pre-wrap text-gray-500 font-light text-14px leading-20px md:text-16px mb-20px">2018-09-27  |  <!-- -->21<!-- -->分钟<!-- -->  |  yrobot  |  <span class="md:hidden">
</span>DOM,操作</div><article class="prose prose-sm break-all md:prose 2xl:prose-lg mb-15px md:mb-20px"><p><a id='top'></a></p>
<p><strong>本页目录：</strong><br><a href="#nh">NodeList 和 HTMLCollection</a><br><a href="#get">获取 DOM 节点的方法</a><br><a href="#create">生成节点的方法</a><br><a href="#action">DOM 操作方法</a><br><a href="#near">关系节点获取</a><br><a href="#props">元素属性设置</a><br><a href="#style">元素样式修改</a><br><a href="#position">获取元素宽高、位置</a></p>
<p><a id='nh'></a></p>
<h2 id="nodelist-和-htmlcollection">NodeList 和 HTMLCollection</h2>
<h4 id="共同点：">共同点：</h4>
<ol>
<li>都是类数组对象，都有 length 属性</li>
<li>都有共同的方法：item，可以通过 item(index)或者 item(id)来访问返回结果中的元素</li>
<li>都是实时变动的（live），document 上的更改会反映到相关对象上（例外：document.querySelectorAll 返回的 NodeList 不是实时的）</li>
</ol>
<h4 id="不同点：">不同点：</h4>
<ol>
<li>NodeList 可以包含任何节点类型（包括换行、元素间的文字），HTMLCollection 只包含元素节点（elementNode），elementNode 就是 HTML 中的标签</li>
<li>HTMLCollection 比 NodeList 多一项方法：namedItem，可以通过传递 id 或 name 属性来获取节点信息</li>
</ol>
<p><a id='get'></a></p>
<h2 id="获取-dom-节点的方法">获取 DOM 节点的方法</h2>
<ol>
<li><p><code>document.getElementById</code> ：根据 ID 查找元素，大小写敏感，如果有多个结果，只返回第一个；只能 document 调用</p>
</li>
<li><p><code>DOM.getElementsByClassName</code> ：根据类名查找元素，多个类名用空格分隔，返回一个 HTMLCollection 。</p>
</li>
<li><p><code>DOM.getElementsByTagName</code> ：根据标签查找元素， * 表示查询所有标签，返回一个 HTMLCollection 。</p>
</li>
<li><p><code>document.getElementsByName</code> ：根据元素的 name 属性查找，返回一个 NodeList 。只能 document 调用</p>
</li>
<li><p><code>DOM.querySelector</code> ：返回单个 Node，如果匹配到多个结果，只返回第一个。</p>
</li>
<li><p><code>DOM.querySelectorAll</code> ：返回一个 NodeList。不是实时的。</p>
</li>
<li><p><code>document.forms</code> ：获取当前页面所有 form，返回一个 HTMLCollection ；</p>
</li>
<li><p><code>document.documentElement</code>：获取 html 节点</p>
</li>
<li><p><code>document.body</code>：获取 body 节点</p>
</li>
</ol>
<p><a id='create'></a></p>
<h2 id="生成节点的方法">生成节点的方法</h2>
<ol>
<li><p><code>document.createElement(&quot;p&quot;)</code>：生成 HTML 节点元素，参数为节点类型</p>
</li>
<li><p><code>document.createTextNode(&quot;text&quot;)</code>:文本内容（无标签包裹），节点间的文本、节点内的文本</p>
</li>
<li><p><code>DOM.cloneNode()</code>：方法创建节点的拷贝，并返回该副本。</p>
</li>
</ol>
<p><a id='action'></a></p>
<h2 id="dom-操作方法">DOM 操作方法</h2>
<h3 id="添加元素：">添加元素：</h3>
<ol>
<li><code>DOM.appendChild(元素)</code>：在 DOM 节点末尾添加元素</li>
<li><code>parentNode.insertBefore(newNode, refNode)</code>：在 redNode 前添加新元素 newNode</li>
<li><code>DOM.insertAdjacentElement(position,ele)</code>：在 DOM 指定位置添加元素</li>
<li><code>DOM.insertAdjacentHTML(position, text)</code>：同上<br><strong>position</strong><br>A DOMString representing the position relative to the element; must be one of the following strings: 相对于 p 节点<br>取值：<code>&#39;beforebegin&#39;</code>、<code>&#39;afterbegin&#39;</code>、<code>&#39;beforeend&#39;</code>、<code>&#39;afterend&#39;</code><pre><code class="language-html"><span class="hljs-comment">&lt;!-- beforebegin --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
  <span class="hljs-comment">&lt;!-- afterbegin --&gt;</span>
  foo
  <span class="hljs-comment">&lt;!-- beforeend --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
<span class="hljs-comment">&lt;!-- afterend --&gt;</span>
</code></pre>
<strong>text</strong><br>text is the string to be parsed as HTML or XML and inserted into the tree.例如<code>&#39;&lt;div id=&quot;two&quot;&gt;two&lt;/div&gt;&#39;</code><br><strong>element</strong><br>要插入到树中的元素.</li>
</ol>
<h3 id="删除元素：">删除元素：</h3>
<ol>
<li><code>parentNode.removeChild(node)</code>：删除 parentNode 下的 node 节点，注意是实时更新的，删除时 index 会时时改变<pre><code class="language-js">function removeNode(<span class="hljs-keyword">node</span><span class="hljs-title">) {
  if</span> (!<span class="hljs-keyword">node</span><span class="hljs-title">) return</span>;
  if (node.parentNode) node.parentNode.removeChild(<span class="hljs-keyword">node</span><span class="hljs-title">);
}</span>
</code></pre>
</li>
<li><code>parentNode.replaceChild(newChild, oldChild)</code>：将 oldChild 替换为 newChild</li>
</ol>
<p><a id='near'></a></p>
<h2 id="关系节点获取">关系节点获取</h2>
<ol>
<li><p><code>parentNode</code> ：返回元素的父节点。Element 的父节点可能是 Element，Document 或 DocumentFragment；</p>
</li>
<li><p><code>parentElement</code> ：返回元素的父元素节点，与 parentNode 的区别在于，其父节点必须是一个 Element 元素，如果不是，则返回 null；</p>
</li>
<li><p><code>children</code> ：返回一个实时的 HTMLCollection ，子节点都是 Element，IE9 以下浏览器不支持；</p>
</li>
<li><p><code>childNodes</code> ：返回一个实时的 NodeList ，表示元素的子节点列表，注意子节点可能包含文本节点、注释节点等；</p>
</li>
<li><p><code>firstChild</code> ：返回第一个子节点，不存在返回 null，与之相对应的还有一个 firstElementChild ；</p>
</li>
<li><p><code>lastChild</code> ：返回最后一个子节点，不存在返回 null，与之相对应的还有一个 lastElementChild ；</p>
</li>
<li><p><code>previousSibling</code> ：返回节点的前一个节点，如果不存在则返回 null。注意有可能拿到的节点是文本节点或注释节点。</p>
</li>
<li><p><code>nextSibling</code> ：返回节点的后一个节点，如果不存在则返回 null。注意有可能拿到的节点是文本节点或注释节点。</p>
</li>
<li><p><code>previousElementSibling</code> ：返回前一个 element 元素节点，前一个节点必须是 Element，注意 IE9 以下浏览器不支持。</p>
</li>
<li><p><code>nextElementSibling</code> ：返回后一个 element 元素节点，后一个节点必须是 Element，注意 IE9 以下浏览器不支持。</p>
</li>
</ol>
<p><a id='props'></a></p>
<h2 id="元素属性设置">元素属性设置</h2>
<ol>
<li><p><code>DOM.setAttribute(name, value)</code>: name 是特性名，value 是特性值，如 DOM.setAttribute(&#39;name&#39;, &#39;ele&#39;);</p>
</li>
<li><p><code>DOM.getAttribute(name)</code>: 返回指定的特性名相应的特性值，如果不存在，则返回 nul</p>
</li>
<li><p><code>DOM.hasAttribute(name)</code>: 判断 DOM 是否存在 name 的属性</p>
</li>
<li><p><code>DOM.dataset</code>: 获取 html data-开头的属性</p>
<pre><code class="language-js">&lt;div id=<span class="hljs-string">&#x27;user&#x27;</span> data-id=<span class="hljs-string">&#x27;1234567890&#x27;</span> data-user=<span class="hljs-string">&#x27;johndoe&#x27;</span> data-date-of-birth&gt;
  John Doe
&lt;/div&gt;;

let el = document.querySelector(<span class="hljs-string">&#x27;#user&#x27;</span>);
<span class="hljs-regexp">//</span> el.id == <span class="hljs-string">&#x27;user&#x27;</span>
<span class="hljs-regexp">//</span> el.dataset.id === <span class="hljs-string">&#x27;1234567890&#x27;</span>
<span class="hljs-regexp">//</span> el.dataset.user === <span class="hljs-string">&#x27;johndoe&#x27;</span>
<span class="hljs-regexp">//</span> el.dataset.dateOfBirth === <span class="hljs-string">&#x27;&#x27;</span>

el.dataset.dateOfBirth = <span class="hljs-string">&#x27;1960-10-03&#x27;</span>; <span class="hljs-regexp">//</span> set the DOB.
<span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;someDataAttr&#x27;</span> <span class="hljs-keyword">in</span> el.dataset === false

el.dataset.someDataAttr = <span class="hljs-string">&#x27;mydata&#x27;</span>;
<span class="hljs-regexp">//</span> <span class="hljs-string">&#x27;someDataAttr&#x27;</span> <span class="hljs-keyword">in</span> el.dataset === true
</code></pre>
</li>
</ol>
<p><a id='style'></a></p>
<h2 id="元素样式修改">元素样式修改</h2>
<ol>
<li><p>直接修改元素 style 样式： <em><code>element.sytle.xxx</code>只能获取到内联样式</em></p>
<pre><code class="language-js"><span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.<span class="hljs-built_in">color</span> = &#x27;red&#x27;;
<span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.setProperty(&#x27;<span class="hljs-built_in">font</span>-size&#x27;, &#x27;16px&#x27;);
<span class="hljs-built_in">elem</span>.<span class="hljs-built_in">style</span>.removeProperty(&#x27;<span class="hljs-built_in">color</span>&#x27;);
</code></pre>
</li>
<li><p>动态添加样式规则：</p>
<pre><code class="language-js"><span class="hljs-built_in">var</span> <span class="hljs-built_in">style</span> = document.createElement(&#x27;<span class="hljs-built_in">style</span>&#x27;);
<span class="hljs-built_in">style</span>.innerHTML = &#x27;body{<span class="hljs-built_in">color</span>:red} #top:hover{<span class="hljs-built_in">background</span>-<span class="hljs-built_in">color</span>: red;<span class="hljs-built_in">color</span>: white;}&#x27;;
document.head.appendChild(<span class="hljs-built_in">style</span>);
</code></pre>
</li>
<li><p>classList 获取样式 class<br><strong><code>DOM.classList.xxx()</code>:</strong></p>
<ul>
<li>add( String [, String] )<br>添加指定的类值。如果这些类已经存在于元素的属性中，那么它们将被忽略。</li>
<li>remove( String [,String] )<br>删除指定的类值。</li>
<li>item ( Number )<br>按集合中的索引返回类值。</li>
<li>toggle ( String [, force] )<br>当只有一个参数时：切换 class value; 即如果类存在，则删除它并返回 false，如果不存在，则添加它并返回 true。<br>当存在第二个参数时：如果第二个参数的计算结果为 true，则添加指定的类值，如果计算结果为 false，则删除它</li>
<li>contains( String )<br>检查元素的类属性中是否存在指定的类值。</li>
<li>replace( String, String )<br>用一个新类替换已有类。</li>
</ul>
</li>
<li><p>使用<code>window.getComputedStyle</code>： <em>借助<code>window.getComputedStyle</code>可以获取应用到元素上的所有样式</em><br><code>let style = window.getComputedStyle(element, [pseudoElt]);</code></p>
<ul>
<li>element<br>用于获取计算样式的 Element。</li>
<li>pseudoElt [可选]<br>指定一个要匹配的伪元素的字符串。必须对普通元素省略（或 null）。</li>
</ul>
<p>返回的 style 是一个实时的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CSSStyleDeclaration">CSSStyleDeclaration</a> 对象，当元素的样式更改时，它会自动更新本身。</p>
<pre><code class="language-js"><span class="hljs-keyword">let</span> elem = document.get<span class="hljs-constructor">ElementById(&#x27;<span class="hljs-params">elem</span>-<span class="hljs-params">container</span>&#x27;)</span>;
window.get<span class="hljs-constructor">ComputedStyle(<span class="hljs-params">elem</span>, <span class="hljs-params">null</span>)</span>.height = &#x27;<span class="hljs-number">100</span>px&#x27;;
</code></pre>
</li>
</ol>
<p><a id='position'></a></p>
<h2 id="获取元素宽高、位置">获取元素宽高、位置</h2>
<ol>
<li><p><code>getBoundingClientRect()</code>:<br><code>DOM.getBoundingClientRect()</code>的属性：</p>
<table>
<thead>
<tr>
<th>Attribute</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>bottom</td>
<td>float</td>
<td>Y 轴，相对于视口原点（viewport origin）矩形盒子的底部。只读。</td>
</tr>
<tr>
<td>height</td>
<td>float</td>
<td>矩形盒子的高度（等同于 bottom 减 top）。只读。</td>
</tr>
<tr>
<td>left</td>
<td>float</td>
<td>X 轴，相对于视口原点（viewport origin）矩形盒子的左侧。只读。</td>
</tr>
<tr>
<td>right</td>
<td>float</td>
<td>X 轴，相对于视口原点（viewport origin）矩形盒子的右侧。只读。</td>
</tr>
<tr>
<td>top</td>
<td>float</td>
<td>Y 轴，相对于视口原点（viewport origin）矩形盒子的顶部。只读。</td>
</tr>
<tr>
<td>width</td>
<td>float</td>
<td>矩形盒子的宽度（等同于 right 减 left）。只读。</td>
</tr>
<tr>
<td>x</td>
<td>float</td>
<td>X 轴，相对于视口原点（viewport origin）矩形盒子的左侧。只读。</td>
</tr>
<tr>
<td>y</td>
<td>float</td>
<td>Y 轴，相对于视口原点（viewport origin）矩形盒子的顶部。只读。</td>
</tr>
<tr>
<td>clientRect 是一个 DOMRect 对象，包含 width、height、left、top、right、bottom，它是相对于窗口顶部而不是文档顶部，<strong>滚动页面时它们的值是会发生变化的</strong>。</td>
<td></td>
<td></td>
</tr>
</tbody></table>
</li>
<li><p><code>DOM.clientWidth</code>：表示元素的内部宽度，以像素计。盒模型的 content+padding</p>
</li>
<li><p><code>DOM.offsetLeft</code>：返回当前元素左上角相对于 HTMLElement.offsetParent (距离元素的最近的父级定位元素) 节点的左边界偏移的像素值。</p>
</li>
<li><p><code>DOM.scrollLeft</code> 属性可以读取或设置元素滚动条到元素左边的距离。</p>
</li>
</ol>
</article><div class="overflow-hidden flex flex-row items-center justify-between pt-10px md:pt-15px border-t-1px border-gray-200 mb-20px md:mb-40px"><span class="iconfont iconleft flex-none w-14px h-14px text-14px md:w-16px md:h-16px md:text-16px md:mr-4px"></span><a href="/blog/微信小程序/小程序的分享与传参" class="flex-none w-40% text-14px leading-16px md:text-16px overflow-hidden whitespace-nowrap overflow-ellipsis">小程序的分享与传参</a><div class="mx-auto"></div><a href="/blog/SPA/react的状态管理/利用react-redux" class="flex-none w-40% text-right text-14px leading-16px md:text-16px overflow-hidden whitespace-nowrap overflow-ellipsis">react的状态管理—利用react-redux</a><span class="iconfont iconright flex-none w-14px h-14px text-14px md:w-16px md:h-16px md:text-16px md:ml-4px"></span></div><div class="mb-20px"><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div id="vcomments"></div></div></div><div class="2xl:flex-none 2xl:w-580px"><div class="pt-24px md:pt-24px 2xl:pt-30px mb-15px md:mb-20px"><div class="relative card pl-20px flex flex-col items-start justify-center h-96px md:h-126px 2xl:h-160px pr-120px md:pr-170px 2xl:pr-195px"><div class="text-20px md:text-26px 2xl:text-36px font-bold mb-10px md:mb-15px 2xl:mb-15px">你好！我是Yrobot</div><div class="text-14px md:text-16px 2xl:text-16px">欢迎来到我的博客，希望你在这里玩得开心！</div><img class="h-120px md:h-150px 2xl:h-190px absolute bottom-0 right-20px" src="/assets/person.svg" alt="person"/></div></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot" target="_blank"><img src="https://github-readme-stats.vercel.app/api?count_private=true&amp;show_icons=true&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot/mina-touch" target="_blank"><img src="https://github-readme-stats.vercel.app/api/pin?repo=mina-touch&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot/react-mobile-table" target="_blank"><img src="https://github-readme-stats.vercel.app/api/pin?repo=react-mobile-table&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot/mina-popups" target="_blank"><img src="https://github-readme-stats.vercel.app/api/pin?repo=mina-popups&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div></div></div></div><footer class="bg-accent-1"></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"pre":{"path":"_blogs/微信小程序/小程序的分享与传参.md","url":"/blog/微信小程序/小程序的分享与传参","title":"小程序的分享与传参","author":"yrobot","keywords":"小程序,传参,分享","createTime":1538236800000,"length":5284,"content":"\u003cp\u003e\u003cstrong\u003e本页目录：\u003c/strong\u003e\u003cbr\u003e\u003ca href=\"#before\"\u003e事先说明\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#share\"\u003e分享方法概括\u003c/a\u003e  \u003c/p\u003e\n\u003cp\u003e分享传参\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#url\"\u003e利用URL参数\u003c/a\u003e  \u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#qrcode\"\u003e二维码传参\u003c/a\u003e  \u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#st\"\u003eshareTicket\u003c/a\u003e  \u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#cb\"\u003e剪切板传参\u003c/a\u003e  \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca href=\"#note\"\u003e分享的注意点\u003c/a\u003e  \u003c/p\u003e\n\u003cp\u003e\u003ca id='before'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"事先说明\"\u003e事先说明\u003c/h2\u003e\n\u003cp\u003e首先要说的就是\u003cbr\u003e微信仗着自己的生态圈日益完善，随随便便就可以废弃或者改动API\u003ccode\u003e(比如这次的分享回调函数)\u003c/code\u003e\u003cbr\u003e所以本文只能做到说，对于目前\u003ccode\u003e2018年09月30日\u003c/code\u003e这个时间结点，我所做的总结是没有问题的   \u003c/p\u003e\n\u003cp\u003e再说一下做本次总结的初衷，或者是出发点  \u003c/p\u003e\n\u003cp\u003e最近要负责一个信用卡的小程序项目\u003cbr\u003e我主要负责的就是项目的前端开发\u003cbr\u003e那么一系列关于分享的问题就来了  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e什么这个页面能不能生成链接放群里啊\u003c/li\u003e\n\u003cli\u003e小程序能不能分享到朋友圈啊\u003c/li\u003e\n\u003cli\u003e分享对接到个人，进而引入任务机制啊\u003c/li\u003e\n\u003cli\u003e能不能查看每个人发展了几个新用户啊\u003c/li\u003e\n\u003cli\u003e朋友圈分享加入参数怎么实现啊\u003c/li\u003e\n\u003cli\u003e巴拉巴拉\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e呼~  \u003c/p\u003e\n\u003cp\u003e索性做一次比较系统的总结吧\u003cbr\u003e看你们谁敢再提一些xx的需求  \u003c/p\u003e\n\u003cp\u003e\u003ca id='share'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"分享方法概括\"\u003e分享方法概括\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e利用page生命周期onShareAppMessage()\u003c/li\u003e\n\u003cli\u003e基于\b二维码图片进行分享\u003c/li\u003e\n\u003cli\u003e通过剪切板分享   \u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"1-利用page生命周期onshareappmessage\"\u003e1. 利用page生命周期onShareAppMessage()\u003c/h3\u003e\n\u003cp\u003e只有设置了onShareAppMessage()函数\u003cbr\u003e点击小程序右上角才会有分享选项\u003cbr\u003ebutton方式的分享才会成功  \u003c/p\u003e\n\u003cp\u003e具体API使用参考\u003ca href=\"https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#%E9%A1%B5%E9%9D%A2%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0\"\u003e官网-页面事件处理函数\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e优点：\u003c/strong\u003e\u003cbr\u003e这个方法好的地方就是可以直接分享给用户和群\u003cbr\u003e用户点击链接直接跳转小程序\u003cbr\u003e非常方便，转化率也高  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e缺点：\u003c/strong\u003e\u003cbr\u003e不支持以链接形式分享到朋友圈  \u003c/p\u003e\n\u003ch3 id=\"2-\b基于\b二维码图片进行分享\"\u003e2. \b基于\b二维码图片进行分享\u003c/h3\u003e\n\u003cp\u003e生成小程序二维码需要获取access_token\u003cbr\u003e然后利用\u003ca href=\"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/qr-code.html\"\u003e官方的接口\u003c/a\u003e去获取二维码\u003cbr\u003e接口返回数据为二维码的二进制数据  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e需要注意的是：\u003c/strong\u003e\u003cbr\u003e官方的接口有3个\u003cbr\u003e但是1、3的接口生成个数总和不得超过100000，但参数长度够长\u003cbr\u003e2接口不限制总个数，生成频率也很大，但是2号接口的参数整体不得多于32个可见字符\u003cbr\u003e这需要开发的取舍，或者进行适当的转换了  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e优点：\u003c/strong\u003e\u003cbr\u003e方法各种场景通用，可以对用户、对朋友圈、甚至支持以其他媒体介质传播  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e缺点：\u003c/strong\u003e\u003cbr\u003e方法操作复杂，转换率比较低\u003cbr\u003e对于老年用户。可能不是很智能\u003cbr\u003e参数可能还需要压缩  \u003c/p\u003e\n\u003ch3 id=\"3-通过剪切板分享\"\u003e3. 通过剪切板分享\u003c/h3\u003e\n\u003cp\u003e这个方法适用的场景很单一\u003cbr\u003e主要是\b各方都在用小程序的情况下\u003cbr\u003e不是用来推广小程序的\u003cbr\u003e而是用来分享具体内容的（前提是都已经在用小程序了） \u003c/p\u003e\n\u003cp\u003e目前淘宝、支付宝这种方式的分享很多  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e需要注意的是：\u003c/strong\u003e\n由于是明文分享，需要做好防修改操作\u003cbr\u003e最好就是以签名的方式进行判断  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e优点：\u003c/strong\u003e\u003cbr\u003e分享途径不受限制\u003cbr\u003e分享方法也很简单  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e缺点：\u003c/strong\u003e\u003cbr\u003e不适用小程序的推广，单纯的内部分享\u003cbr\u003e打开小程序后才能被监听  \u003c/p\u003e\n\u003cp\u003e\u003ca id='url'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"利用url参数\"\u003e利用URL参数\u003c/h2\u003e\n\u003ch4 id=\"方法简述\"\u003e方法简述\u003c/h4\u003e\n\u003cp\u003e就是前段最朴素的传参，在url后添加?name=value的形式，然后利用路由或者小程序自带的方法读取参数   \u003c/p\u003e\n\u003ch4 id=\"方法步骤\"\u003e方法步骤\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e在页面onShareAppMessage()配置返回的url，以path?name=value的形式  \u003c/li\u003e\n\u003cli\u003e获取参数：  \u003col\u003e\n\u003cli\u003e在Page的onLoad生命周期的参数 \u003ccode\u003eoption.参数名\u003c/code\u003e 获取参数值\u003c/li\u003e\n\u003cli\u003e还可以在APP的onLaunch生命周期的参数 \u003ccode\u003eoptions.query.参数名\u003c/code\u003e 获取\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"注意点\"\u003e注意点\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e关于参数的问题，onShareAppMessage()没有指明是否可以在tab页面的url带参数，但是wx路由API指明只能在跳转非tab页时带参数 。  \u003c/li\u003e\n\u003cli\u003e必须触发Page的onLoad或者APP的onLaunch才获取的到参数  \u003ch4 id=\"测试结果：\"\u003e测试结果：\u003c/h4\u003e\n直接打开：\n\u003cimg src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fvrmzyjpbkj30v80jignm.jpg\" alt=\"\"\u003e\n从分享链接打开：\n\u003cimg src=\"https://ws3.sinaimg.cn/large/006tNc79gy1fvrn0kxyohj30ve0m0tax.jpg\" alt=\"\"\u003e\n\u003ca id='qrcode'\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"二维码传参\"\u003e二维码传参\u003c/h2\u003e\n\u003ch4 id=\"方法简述-1\"\u003e方法简述\u003c/h4\u003e\n\u003cp\u003e利用小程序生成二维码的API生成二维码，让用户直接分享二维码  \u003c/p\u003e\n\u003ch4 id=\"方法步骤-1\"\u003e方法步骤\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e利用appID和appSECRET获取access_token\u003c/li\u003e\n\u003cli\u003e利用access_token作为参数请求二维码API\u003c/li\u003e\n\u003cli\u003e接口返回二维码的二进制数据，处理成url\u003c/li\u003e\n\u003cli\u003e利用wx接口下载url并保存\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"注意点-1\"\u003e注意点\u003c/h4\u003e\n\u003cp\u003e官方二维码生成接口有3种方法，具体参考\u003ca href=\"https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/qr-code.html\"\u003e官方API\u003c/a\u003e\u003cbr\u003e三种方式的参数和url，data格式都不一样，具体可以参考\u003ca href=\"https://www.jianshu.com/p/441882c67b6a\"\u003e博客链接\u003c/a\u003e   \u003c/p\u003e\n\u003cp\u003e注意1、3一共只能生成10000个二维码，2的参数长度不能那个超过32个字符\u003cbr\u003e接口返回的图片二进制，最好是在服务端储存然后返回链接给前端。\u003cbr\u003e\u003ca id='st'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"shareticket\"\u003eshareTicket\u003c/h2\u003e\n\u003ch4 id=\"方法简述-2\"\u003e方法简述\u003c/h4\u003e\n\u003cp\u003eshareTicket的作用是用来换取 群的openID  \u003c/p\u003e\n\u003ch4 id=\"方法步骤-2\"\u003e方法步骤\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e在showSHareMenu()或者updateShareMenu()中设置shareTicket为true\u003c/li\u003e\n\u003cli\u003e将小程序分享到群中\u003c/li\u003e\n\u003cli\u003e有用户打开此链接后,即可在App.onLaunch 或 App.onShow 获取到一个 shareTicket\u003c/li\u003e\n\u003cli\u003e利用wx.getShareInfo将shareTicket转化成加密数据\u003c/li\u003e\n\u003cli\u003e加密数据解密后获得 群openID \u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"注意点-2\"\u003e注意点\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e18年10月10号，微信关闭分享回调函数，所以无法再用户分享会后立刻获得shareTicket\u003c/li\u003e\n\u003cli\u003e使用App.onLaunch获取要注意，App.onLaunch只在小程序初始化时触发，即当已经打开小程序，再去群里点击链接，是不会触发App.onLaunch的。推荐使用App.onShow\u003ch4 id=\"代码演示\"\u003e代码演示\u003c/h4\u003e\ndemo7.js:\u003cpre\u003e\u003ccode\u003eonShareAppMessage: \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e (res) {\n return {\n     title: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;Yrobot test share\u0026#x27;\u003c/span\u003e,\n     path: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;pages/demo7/index?shareID=Yrobot7\u0026#x27;\u003c/span\u003e\n }\n},\nonShow: \u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e () {\n \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e setTimeout(() =\u0026gt; {\n \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e     wx.redirectTo({\n \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e         url: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;../demo5/index\u0026#x27;\u003c/span\u003e\n \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e     }) \n \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e }, \u003cspan class=\"hljs-number\"\u003e6000\u003c/span\u003e);\n wx.showShareMenu({\n     withShareTicket: true,\n });\n},\n\u003c/code\u003e\u003c/pre\u003e\nApp.js:\u003cpre\u003e\u003ccode\u003eonShow: \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e =\u0026gt; {\n console.\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;App.onShow\u0026#x27;\u003c/span\u003e);\n console.\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;shareID: \u0026#x27;\u003c/span\u003e + \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.query.shareID);\n wx.getShareInfo({\n   shareTicket: \u003cspan class=\"hljs-keyword\"\u003eoptions\u003c/span\u003e.shareTicket,\n   success: res =\u0026gt; {\n     console.\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;wx.getShareInfo:success:\u0026#x27;\u003c/span\u003e);\n     console.\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e(res);\n   },\n   fail: res =\u0026gt; {\n     console.\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;wx.getShareInfo:fail\u0026#x27;\u003c/span\u003e);\n     console.\u003cspan class=\"hljs-built_in\"\u003elog\u003c/span\u003e(res);\n   }\n });\n},\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch4 id=\"效果展示\"\u003e效果展示\u003c/h4\u003e\n\u003cimg src=\"https://ws2.sinaimg.cn/large/006tNc79gy1fvro07yrz1j30ws0m0wsy.jpg\" alt=\"\"\u003e\n\u003ca id='cb'\u003e\u003c/a\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"剪切板传参\"\u003e剪切板传参\u003c/h2\u003e\n\u003ch4 id=\"方法简述-3\"\u003e方法简述\u003c/h4\u003e\n\u003cp\u003e利用剪切板监听的方式，获取页面和参数\u003cbr\u003e功能类似于淘宝、支付宝的分享   \u003c/p\u003e\n\u003ch4 id=\"方法内容\"\u003e方法内容\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e利用wx.setClipboardData设置剪切板内容  \u003c/li\u003e\n\u003cli\u003e利用wx.getClipboardData获取剪切内容  \u003c/li\u003e\n\u003cli\u003e监听到剪切板时当前小程序的分享字符串时，进行解析、跳转  \u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"注意点-3\"\u003e注意点\u003c/h4\u003e\n\u003cp\u003e注意传参的话最好进行加密混淆、否则明码容易被用户手动替换\u003cbr\u003e最好就是对整体进行签名，签名认证不一致(用户修改过)就不进行解析   \u003c/p\u003e\n\u003ch4 id=\"效果展示：\"\u003e效果展示：\u003c/h4\u003e\n\u003cp\u003e初始进入：\u003cbr\u003e    \u003cimg src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fvrkc3incyj30gg0ncwfg.jpg\" alt=\"\"\u003e\u003cbr\u003e复制指令后进入：\u003cbr\u003e    \u003cimg src=\"https://ws4.sinaimg.cn/large/006tNc79gy1fvrkbv5lqlj30gm0nc3zb.jpg\" alt=\"\"\u003e   \u003c/p\u003e\n\u003cp\u003e\u003ca id='note'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"分享的注意点\"\u003e分享的注意点\u003c/h2\u003e\n\u003cp\u003e由于7月5日微信更新API，减少“强制分享至不同群”等滥用分享能力，将不再支持onShareAppMessage()中获取分享状态(即那三个回调函数)，所以也无法在分享后立刻获得群id，而改为用户打开后利用shareTicket换取群id   \u003c/p\u003e\n\u003cp\u003e具体参考微信公众平台公告：10月10日起新提交发布的版本，不再支持分享回调参数 success 、fail 、complete\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://mp.weixin.qq.com/s?__biz=MjM5NDAwMTA2MA==\u0026amp;mid=2695730124\u0026amp;idx=1\u0026amp;sn=666a448b047d657350de7684798f48d3\u0026amp;chksm=83d74a07b4a0c311569a748f4d11a5ebcce3ba8f6bd5a4b3183a4fea0b3442634a1c71d3cdd0\u0026amp;scene=21#wechat_redirect\"\u003e微信公共平台 - 分享功能调整及小程序组件更新\u003c/a\u003e[时间不准确]\u003cbr\u003e\u003ca href=\"https://mp.weixin.qq.com/cgi-bin/announce?action=getannouncement\u0026amp;announce_id=11526372695t90Dn\u0026amp;version=\u0026amp;lang=zh_CN\"\u003e微信公共平台 - 分享功能调整\u003c/a\u003e[时间不准确]\u003cbr\u003e\u003ca href=\"https://developers.weixin.qq.com/community/develop/doc/0000447a5b431807af57249a551408?highLine=%25E5%2588%2586%25E4%25BA%25AB%25E5%259B%259E%25E8%25B0%2583%25E6%2588%2590%25E5%258A%259F\"\u003e微信开放社区 - “分享监听”能力调整\u003c/a\u003e[时间准确]\u003c/p\u003e\n"},"blog":{"path":"_blogs/JS/DOM操作/README.md","url":"/blog/JS/DOM操作","title":"DOM操作","author":"yrobot","keywords":"DOM,操作","createTime":1537977600000,"length":6382,"content":"\u003cp\u003e\u003ca id='top'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e本页目录：\u003c/strong\u003e\u003cbr\u003e\u003ca href=\"#nh\"\u003eNodeList 和 HTMLCollection\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#get\"\u003e获取 DOM 节点的方法\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#create\"\u003e生成节点的方法\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#action\"\u003eDOM 操作方法\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#near\"\u003e关系节点获取\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#props\"\u003e元素属性设置\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#style\"\u003e元素样式修改\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#position\"\u003e获取元素宽高、位置\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca id='nh'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"nodelist-和-htmlcollection\"\u003eNodeList 和 HTMLCollection\u003c/h2\u003e\n\u003ch4 id=\"共同点：\"\u003e共同点：\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003e都是类数组对象，都有 length 属性\u003c/li\u003e\n\u003cli\u003e都有共同的方法：item，可以通过 item(index)或者 item(id)来访问返回结果中的元素\u003c/li\u003e\n\u003cli\u003e都是实时变动的（live），document 上的更改会反映到相关对象上（例外：document.querySelectorAll 返回的 NodeList 不是实时的）\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch4 id=\"不同点：\"\u003e不同点：\u003c/h4\u003e\n\u003col\u003e\n\u003cli\u003eNodeList 可以包含任何节点类型（包括换行、元素间的文字），HTMLCollection 只包含元素节点（elementNode），elementNode 就是 HTML 中的标签\u003c/li\u003e\n\u003cli\u003eHTMLCollection 比 NodeList 多一项方法：namedItem，可以通过传递 id 或 name 属性来获取节点信息\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='get'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"获取-dom-节点的方法\"\u003e获取 DOM 节点的方法\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.getElementById\u003c/code\u003e ：根据 ID 查找元素，大小写敏感，如果有多个结果，只返回第一个；只能 document 调用\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.getElementsByClassName\u003c/code\u003e ：根据类名查找元素，多个类名用空格分隔，返回一个 HTMLCollection 。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.getElementsByTagName\u003c/code\u003e ：根据标签查找元素， * 表示查询所有标签，返回一个 HTMLCollection 。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.getElementsByName\u003c/code\u003e ：根据元素的 name 属性查找，返回一个 NodeList 。只能 document 调用\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.querySelector\u003c/code\u003e ：返回单个 Node，如果匹配到多个结果，只返回第一个。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.querySelectorAll\u003c/code\u003e ：返回一个 NodeList。不是实时的。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.forms\u003c/code\u003e ：获取当前页面所有 form，返回一个 HTMLCollection ；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.documentElement\u003c/code\u003e：获取 html 节点\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.body\u003c/code\u003e：获取 body 节点\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='create'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"生成节点的方法\"\u003e生成节点的方法\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.createElement(\u0026quot;p\u0026quot;)\u003c/code\u003e：生成 HTML 节点元素，参数为节点类型\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003edocument.createTextNode(\u0026quot;text\u0026quot;)\u003c/code\u003e:文本内容（无标签包裹），节点间的文本、节点内的文本\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.cloneNode()\u003c/code\u003e：方法创建节点的拷贝，并返回该副本。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='action'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"dom-操作方法\"\u003eDOM 操作方法\u003c/h2\u003e\n\u003ch3 id=\"添加元素：\"\u003e添加元素：\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003eDOM.appendChild(元素)\u003c/code\u003e：在 DOM 节点末尾添加元素\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eparentNode.insertBefore(newNode, refNode)\u003c/code\u003e：在 redNode 前添加新元素 newNode\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eDOM.insertAdjacentElement(position,ele)\u003c/code\u003e：在 DOM 指定位置添加元素\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eDOM.insertAdjacentHTML(position, text)\u003c/code\u003e：同上\u003cbr\u003e\u003cstrong\u003eposition\u003c/strong\u003e\u003cbr\u003eA DOMString representing the position relative to the element; must be one of the following strings: 相对于 p 节点\u003cbr\u003e取值：\u003ccode\u003e\u0026#39;beforebegin\u0026#39;\u003c/code\u003e、\u003ccode\u003e\u0026#39;afterbegin\u0026#39;\u003c/code\u003e、\u003ccode\u003e\u0026#39;beforeend\u0026#39;\u003c/code\u003e、\u003ccode\u003e\u0026#39;afterend\u0026#39;\u003c/code\u003e\u003cpre\u003e\u003ccode class=\"language-html\"\u003e\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- beforebegin --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- afterbegin --\u0026gt;\u003c/span\u003e\n  foo\n  \u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- beforeend --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- afterend --\u0026gt;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cstrong\u003etext\u003c/strong\u003e\u003cbr\u003etext is the string to be parsed as HTML or XML and inserted into the tree.例如\u003ccode\u003e\u0026#39;\u0026lt;div id=\u0026quot;two\u0026quot;\u0026gt;two\u0026lt;/div\u0026gt;\u0026#39;\u003c/code\u003e\u003cbr\u003e\u003cstrong\u003eelement\u003c/strong\u003e\u003cbr\u003e要插入到树中的元素.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"删除元素：\"\u003e删除元素：\u003c/h3\u003e\n\u003col\u003e\n\u003cli\u003e\u003ccode\u003eparentNode.removeChild(node)\u003c/code\u003e：删除 parentNode 下的 node 节点，注意是实时更新的，删除时 index 会时时改变\u003cpre\u003e\u003ccode class=\"language-js\"\u003efunction removeNode(\u003cspan class=\"hljs-keyword\"\u003enode\u003c/span\u003e\u003cspan class=\"hljs-title\"\u003e) {\n  if\u003c/span\u003e (!\u003cspan class=\"hljs-keyword\"\u003enode\u003c/span\u003e\u003cspan class=\"hljs-title\"\u003e) return\u003c/span\u003e;\n  if (node.parentNode) node.parentNode.removeChild(\u003cspan class=\"hljs-keyword\"\u003enode\u003c/span\u003e\u003cspan class=\"hljs-title\"\u003e);\n}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eparentNode.replaceChild(newChild, oldChild)\u003c/code\u003e：将 oldChild 替换为 newChild\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='near'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"关系节点获取\"\u003e关系节点获取\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eparentNode\u003c/code\u003e ：返回元素的父节点。Element 的父节点可能是 Element，Document 或 DocumentFragment；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eparentElement\u003c/code\u003e ：返回元素的父元素节点，与 parentNode 的区别在于，其父节点必须是一个 Element 元素，如果不是，则返回 null；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003echildren\u003c/code\u003e ：返回一个实时的 HTMLCollection ，子节点都是 Element，IE9 以下浏览器不支持；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003echildNodes\u003c/code\u003e ：返回一个实时的 NodeList ，表示元素的子节点列表，注意子节点可能包含文本节点、注释节点等；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003efirstChild\u003c/code\u003e ：返回第一个子节点，不存在返回 null，与之相对应的还有一个 firstElementChild ；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003elastChild\u003c/code\u003e ：返回最后一个子节点，不存在返回 null，与之相对应的还有一个 lastElementChild ；\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003epreviousSibling\u003c/code\u003e ：返回节点的前一个节点，如果不存在则返回 null。注意有可能拿到的节点是文本节点或注释节点。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003enextSibling\u003c/code\u003e ：返回节点的后一个节点，如果不存在则返回 null。注意有可能拿到的节点是文本节点或注释节点。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003epreviousElementSibling\u003c/code\u003e ：返回前一个 element 元素节点，前一个节点必须是 Element，注意 IE9 以下浏览器不支持。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003enextElementSibling\u003c/code\u003e ：返回后一个 element 元素节点，后一个节点必须是 Element，注意 IE9 以下浏览器不支持。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='props'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"元素属性设置\"\u003e元素属性设置\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.setAttribute(name, value)\u003c/code\u003e: name 是特性名，value 是特性值，如 DOM.setAttribute(\u0026#39;name\u0026#39;, \u0026#39;ele\u0026#39;);\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.getAttribute(name)\u003c/code\u003e: 返回指定的特性名相应的特性值，如果不存在，则返回 nul\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.hasAttribute(name)\u003c/code\u003e: 判断 DOM 是否存在 name 的属性\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.dataset\u003c/code\u003e: 获取 html data-开头的属性\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003e\u0026lt;div id=\u003cspan class=\"hljs-string\"\u003e\u0026#x27;user\u0026#x27;\u003c/span\u003e data-id=\u003cspan class=\"hljs-string\"\u003e\u0026#x27;1234567890\u0026#x27;\u003c/span\u003e data-user=\u003cspan class=\"hljs-string\"\u003e\u0026#x27;johndoe\u0026#x27;\u003c/span\u003e data-date-of-birth\u0026gt;\n  John Doe\n\u0026lt;/div\u0026gt;;\n\nlet el = document.querySelector(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;#user\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e el.id == \u003cspan class=\"hljs-string\"\u003e\u0026#x27;user\u0026#x27;\u003c/span\u003e\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e el.dataset.id === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;1234567890\u0026#x27;\u003c/span\u003e\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e el.dataset.user === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;johndoe\u0026#x27;\u003c/span\u003e\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e el.dataset.dateOfBirth === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;\u0026#x27;\u003c/span\u003e\n\nel.dataset.dateOfBirth = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;1960-10-03\u0026#x27;\u003c/span\u003e; \u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e set the DOB.\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;someDataAttr\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e el.dataset === false\n\nel.dataset.someDataAttr = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;mydata\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-regexp\"\u003e//\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;someDataAttr\u0026#x27;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ein\u003c/span\u003e el.dataset === true\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='style'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"元素样式修改\"\u003e元素样式修改\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e直接修改元素 style 样式： \u003cem\u003e\u003ccode\u003eelement.sytle.xxx\u003c/code\u003e只能获取到内联样式\u003c/em\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-built_in\"\u003eelem\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003ecolor\u003c/span\u003e = \u0026#x27;red\u0026#x27;;\n\u003cspan class=\"hljs-built_in\"\u003eelem\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e.setProperty(\u0026#x27;\u003cspan class=\"hljs-built_in\"\u003efont\u003c/span\u003e-size\u0026#x27;, \u0026#x27;16px\u0026#x27;);\n\u003cspan class=\"hljs-built_in\"\u003eelem\u003c/span\u003e.\u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e.removeProperty(\u0026#x27;\u003cspan class=\"hljs-built_in\"\u003ecolor\u003c/span\u003e\u0026#x27;);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e动态添加样式规则：\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-built_in\"\u003evar\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e = document.createElement(\u0026#x27;\u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e\u0026#x27;);\n\u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e.innerHTML = \u0026#x27;body{\u003cspan class=\"hljs-built_in\"\u003ecolor\u003c/span\u003e:red} #top:hover{\u003cspan class=\"hljs-built_in\"\u003ebackground\u003c/span\u003e-\u003cspan class=\"hljs-built_in\"\u003ecolor\u003c/span\u003e: red;\u003cspan class=\"hljs-built_in\"\u003ecolor\u003c/span\u003e: white;}\u0026#x27;;\ndocument.head.appendChild(\u003cspan class=\"hljs-built_in\"\u003estyle\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eclassList 获取样式 class\u003cbr\u003e\u003cstrong\u003e\u003ccode\u003eDOM.classList.xxx()\u003c/code\u003e:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eadd( String [, String] )\u003cbr\u003e添加指定的类值。如果这些类已经存在于元素的属性中，那么它们将被忽略。\u003c/li\u003e\n\u003cli\u003eremove( String [,String] )\u003cbr\u003e删除指定的类值。\u003c/li\u003e\n\u003cli\u003eitem ( Number )\u003cbr\u003e按集合中的索引返回类值。\u003c/li\u003e\n\u003cli\u003etoggle ( String [, force] )\u003cbr\u003e当只有一个参数时：切换 class value; 即如果类存在，则删除它并返回 false，如果不存在，则添加它并返回 true。\u003cbr\u003e当存在第二个参数时：如果第二个参数的计算结果为 true，则添加指定的类值，如果计算结果为 false，则删除它\u003c/li\u003e\n\u003cli\u003econtains( String )\u003cbr\u003e检查元素的类属性中是否存在指定的类值。\u003c/li\u003e\n\u003cli\u003ereplace( String, String )\u003cbr\u003e用一个新类替换已有类。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e使用\u003ccode\u003ewindow.getComputedStyle\u003c/code\u003e： \u003cem\u003e借助\u003ccode\u003ewindow.getComputedStyle\u003c/code\u003e可以获取应用到元素上的所有样式\u003c/em\u003e\u003cbr\u003e\u003ccode\u003elet style = window.getComputedStyle(element, [pseudoElt]);\u003c/code\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eelement\u003cbr\u003e用于获取计算样式的 Element。\u003c/li\u003e\n\u003cli\u003epseudoElt [可选]\u003cbr\u003e指定一个要匹配的伪元素的字符串。必须对普通元素省略（或 null）。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e返回的 style 是一个实时的 \u003ca href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/CSSStyleDeclaration\"\u003eCSSStyleDeclaration\u003c/a\u003e 对象，当元素的样式更改时，它会自动更新本身。\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-js\"\u003e\u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e elem = document.get\u003cspan class=\"hljs-constructor\"\u003eElementById(\u0026#x27;\u003cspan class=\"hljs-params\"\u003eelem\u003c/span\u003e-\u003cspan class=\"hljs-params\"\u003econtainer\u003c/span\u003e\u0026#x27;)\u003c/span\u003e;\nwindow.get\u003cspan class=\"hljs-constructor\"\u003eComputedStyle(\u003cspan class=\"hljs-params\"\u003eelem\u003c/span\u003e, \u003cspan class=\"hljs-params\"\u003enull\u003c/span\u003e)\u003c/span\u003e.height = \u0026#x27;\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003epx\u0026#x27;;\n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='position'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"获取元素宽高、位置\"\u003e获取元素宽高、位置\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003egetBoundingClientRect()\u003c/code\u003e:\u003cbr\u003e\u003ccode\u003eDOM.getBoundingClientRect()\u003c/code\u003e的属性：\u003c/p\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eAttribute\u003c/th\u003e\n\u003cth\u003eType\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\u003ctr\u003e\n\u003ctd\u003ebottom\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003eY 轴，相对于视口原点（viewport origin）矩形盒子的底部。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eheight\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003e矩形盒子的高度（等同于 bottom 减 top）。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eleft\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003eX 轴，相对于视口原点（viewport origin）矩形盒子的左侧。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eright\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003eX 轴，相对于视口原点（viewport origin）矩形盒子的右侧。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003etop\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003eY 轴，相对于视口原点（viewport origin）矩形盒子的顶部。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ewidth\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003e矩形盒子的宽度（等同于 right 减 left）。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ex\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003eX 轴，相对于视口原点（viewport origin）矩形盒子的左侧。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003ey\u003c/td\u003e\n\u003ctd\u003efloat\u003c/td\u003e\n\u003ctd\u003eY 轴，相对于视口原点（viewport origin）矩形盒子的顶部。只读。\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003eclientRect 是一个 DOMRect 对象，包含 width、height、left、top、right、bottom，它是相对于窗口顶部而不是文档顶部，\u003cstrong\u003e滚动页面时它们的值是会发生变化的\u003c/strong\u003e。\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003ctd\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\u003c/table\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.clientWidth\u003c/code\u003e：表示元素的内部宽度，以像素计。盒模型的 content+padding\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.offsetLeft\u003c/code\u003e：返回当前元素左上角相对于 HTMLElement.offsetParent (距离元素的最近的父级定位元素) 节点的左边界偏移的像素值。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e\u003ccode\u003eDOM.scrollLeft\u003c/code\u003e 属性可以读取或设置元素滚动条到元素左边的距离。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n"},"next":{"path":"_blogs/SPA/react的状态管理/利用react-redux.md","url":"/blog/SPA/react的状态管理/利用react-redux","title":"react的状态管理—利用react-redux","author":"yrobot","keywords":"react,redux,状态管理,利用","createTime":1537632000000,"length":3545,"content":"\u003cp\u003e\u003cstrong\u003e本页目录：\u003c/strong\u003e\u003cbr\u003e\u003ca href=\"#index\"\u003e场景思考\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#redux\"\u003e利用react-redux\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#result\"\u003e查看效果\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#code\"\u003e查看代码\u003c/a\u003e  \u003c/p\u003e\n\u003cp\u003e\u003ca id='index'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"场景思考\"\u003e场景思考\u003c/h2\u003e\n\u003cp\u003e现在我们用react去写一篇博客\u003cbr\u003e博客包含 \u003ccode\u003e标题\u003c/code\u003e 和 \u003ccode\u003e内容\u003c/code\u003e\u003cbr\u003e而我期望\u003ccode\u003e标题\u003c/code\u003e和\u003ccode\u003e内容\u003c/code\u003e的颜色可以一键修改  \u003c/p\u003e\n\u003cp\u003e当然最暴力的实现方式就是利用dom操作去被动的修改\u003cbr\u003e但是有没有更优雅更可控的方式呢？  \u003c/p\u003e\n\u003cp\u003e首先来看看项目的组件树：\u003cbr\u003e\u003cimg src=\"https://ws1.sinaimg.cn/large/006tNbRwgy1fvekxo7hlhj30c00aj0sy.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e那么有什么好的优雅的方式使\u003ccode\u003eTitle\u003c/code\u003e和\u003ccode\u003eContent\u003c/code\u003e的颜色保持一致呢？\u003cbr\u003e换句话说，怎么更好的管理\u003ccode\u003eTitle\u003c/code\u003e和\u003ccode\u003eContent\u003c/code\u003e的状态呢？ \u003c/p\u003e\n\u003ch4 id=\"回顾上一节\"\u003e回顾上一节\u003c/h4\u003e\n\u003cp\u003e上一节我们使用react自带的 \u003ca href=\"../%E5%88%A9%E7%94%A8context%E6%B3%A8%E5%85%A5\"\u003e\b利用context注入\u003c/a\u003e 方法\u003cbr\u003e利用react的context去实现状态共享很方便\u003cbr\u003e但是react的context还是实验性的，何时会更新无法预知\u003cbr\u003e所以为了保证软件的稳定性，我们还是使用react推荐的第三方状态管理redux   \u003c/p\u003e\n\u003cp\u003e\u003ca id='redux'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"利用react-redux\"\u003e利用react-redux\u003c/h2\u003e\n\u003cp\u003eredux 是一套专业解决应用状态管理的独立的通用模块\b\u003cbr\u003e它不仅可以和react结合，形成react-redux，也可以和vue、angular结合  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ereact-redux的作用：\u003c/strong\u003e 类似于\breact的context，\breact-redux在顶层组件利用Provider将store注入，在需要用到状态的组件处用connect函数包裹，从组件的props中获取store  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ereact-redux的使用方法：\u003c/strong\u003e  \u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e根据全局数据，将其拆分为多个\u003ccode\u003ereducer\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e对于每个\u003ccode\u003ereducer\u003c/code\u003e分配\u003ccode\u003estate\u003c/code\u003e（\u003ccode\u003ereducers.reducer\u003c/code\u003e）和\u003ccode\u003eaction\u003c/code\u003e，处理对应的\u003ccode\u003eaction\u003c/code\u003e操作，生成行的\u003ccode\u003estate\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e将\u003ccode\u003ereducer\u003c/code\u003e合并成\u003ccode\u003ereducers\u003c/code\u003e,\u003ccode\u003ereducers\u003c/code\u003e分配传入的\u003ccode\u003estate\u003c/code\u003e和\u003ccode\u003eaction\u003c/code\u003e操作到\u003ccode\u003ereducer\u003c/code\u003e \u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecreateStore()\u003c/code\u003e传入\u003ccode\u003ereducers\u003c/code\u003e生成\u003ccode\u003estore\u003c/code\u003e，并用\u003ccode\u003eProvider\u003c/code\u003e将\u003ccode\u003estore\u003c/code\u003e注入顶层组件\u003c/li\u003e\n\u003cli\u003e在要引用\u003ccode\u003estore\u003c/code\u003e的组件部分用\u003ccode\u003econnect()\u003c/code\u003e连接，\u003ccode\u003econnect()\u003c/code\u003e会注册监听、将\u003ccode\u003edispatch()\u003c/code\u003e[默认写入]和\u003ccode\u003emapStateToProps\u003c/code\u003e的属性写入\u003ccode\u003eprops\u003c/code\u003e，当然如果使用\u003ccode\u003emapDispatchToProps\u003c/code\u003e生成的\u003ccode\u003eaction creator\u003c/code\u003e也会写入\u003ccode\u003eprops\u003c/code\u003e。\u003c/li\u003e\n\u003cli\u003e在组件中通过\u003ccode\u003eprops\u003c/code\u003e获取5中写入\u003ccode\u003eprops\u003c/code\u003e的数据即可使用。\u003c/li\u003e\n\u003cli\u003e通过\u003ccode\u003edispatch()\u003c/code\u003e的参数会触发\u003ccode\u003ereducers\u003c/code\u003e的\u003ccode\u003eaction\u003c/code\u003e操作，从而更新状态  \u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"https://ws2.sinaimg.cn/large/006tNbRwgy1fvlqv6xb3uj30yu0sagqj.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ereact-redux的优势：\u003c/strong\u003e \u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e相对于react自带的context，react-redux更加稳定成熟，并对性能进行了优化  \u003c/li\u003e\n\u003cli\u003e相对于props的状态提升，react-redux更加的方便简洁，整个全局状态也更加清晰   \u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003e老话说的好，杀鸡焉用牛刀，在简单场景直接使用状态提升即可\u003c/strong\u003e  \u003c/p\u003e\n\u003cp\u003e\u003ca id='result'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"查看效果\"\u003e查看效果\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cimg src=\"https://ws3.sinaimg.cn/large/006tNbRwgy1fvhmmoieh4j31kw0nxdpk.jpg\" alt=\"\"\u003e\u003c/li\u003e\n\u003cli\u003e\u003cimg src=\"https://ws2.sinaimg.cn/large/006tNbRwgy1fvhmmukgfyj31kw0o2qcy.jpg\" alt=\"\"\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='code'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"查看代码\"\u003e查看代码\u003c/h2\u003e\n\u003cp\u003ereducers.js生成全局状态：  \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eimport { combineReducers } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u0026#x27;redux\u0026#x27;\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e mainColor = (\u003cspan class=\"hljs-keyword\"\u003estate\u003c/span\u003e = \u0026#x27;black\u0026#x27;,action)=\u0026gt;{\n    switch (action.type){\n        case \u0026#x27;CHANGE_COLOR\u0026#x27;:\n            \u003cspan class=\"hljs-keyword\"\u003estate\u003c/span\u003e = action.color;\n            return \u003cspan class=\"hljs-keyword\"\u003estate\u003c/span\u003e;\n        \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e:\n            return \u003cspan class=\"hljs-keyword\"\u003estate\u003c/span\u003e;\n    }\n}\n\nexport \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e combineReducers({\n    mainColor,\n})\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eBlogPage.js中\b生成store，并利用Provider注入顶层组件：\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e reducers \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./reducers.js\u0026#x27;\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e store = createStore(reducers);\n\n\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eBlogPage\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eComponent\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprops\u003c/span\u003e)\u003c/span\u003e {\n        \u003cspan class=\"hljs-built_in\"\u003esuper\u003c/span\u003e(props);\n        \u003cspan class=\"hljs-built_in\"\u003ethis\u003c/span\u003e.state = {\n        }\n    }\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003erender\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e)\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eProvider\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estore\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e{store}\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e =\u003cspan class=\"hljs-string\"\u003e\u0026quot;blogContainer\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eHeader\u003c/span\u003e \u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eHeader\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eMain\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eMain\u003c/span\u003e\u0026gt;\u003c/span\u003e\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eProvider\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n        );\n    }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e BlogPage;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eContent.js中利用connect()函数将状态写入组件props：  \u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\u003cspan class=\"hljs-class\"\u003e\u003cspan class=\"hljs-keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eContent\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eComponent\u003c/span\u003e \u003c/span\u003e{\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003econstructor\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003eprops\u003c/span\u003e)\u003c/span\u003e {\n        \u003cspan class=\"hljs-built_in\"\u003esuper\u003c/span\u003e(props);\n        \u003cspan class=\"hljs-built_in\"\u003ethis\u003c/span\u003e.state = {}\n    }\n    \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-title\"\u003erender\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e)\u003c/span\u003e {\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e {mainColor,changeMainColor} = \u003cspan class=\"hljs-built_in\"\u003ethis\u003c/span\u003e.props;\n        \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e (\n            \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;content\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003estyle\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{{\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ecolor:\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003emainColor\u003c/span\u003e }}\u0026gt;\u003c/span\u003e\n                内容...\n                \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eonClick\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e{()\u003c/span\u003e =\u0026gt;\u003c/span\u003e { changeMainColor(\u0026#x27;#\u0026#x27; + (Math.random() * 0xffffff \u0026lt;\u0026lt; 0).toString(16)) }}\u0026gt;切换颜色\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n\n        );\n    }\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e mapStateToProps = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003estate\u003c/span\u003e =\u0026gt;\u003c/span\u003e ({  \u003cspan class=\"hljs-comment\"\u003e//引入状态到props，并注册监听变化\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003emainColor\u003c/span\u003e: state.mainColor\n})\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e mapDispatchToProps = \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003edispatch\u003c/span\u003e =\u0026gt;\u003c/span\u003e ({ \u003cspan class=\"hljs-comment\"\u003e//引入方法到props\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003echangeMainColor\u003c/span\u003e: \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-params\"\u003ecolor\u003c/span\u003e =\u0026gt;\u003c/span\u003e {\n        dispatch({\n            \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e:\u003cspan class=\"hljs-string\"\u003e\u0026#x27;CHANGE_COLOR\u0026#x27;\u003c/span\u003e,\n            color,\n        })\n    }\n})\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e connect(  \u003cspan class=\"hljs-comment\"\u003e//绑定组件 //高阶组件:函数接受一个组件作为参数，并返回一个新的组件\u003c/span\u003e\n    mapStateToProps,\n    mapDispatchToProps\n)(Content);\n\u003c/code\u003e\u003c/pre\u003e\n"}},"__N_SSG":true},"page":"/blog/[...path]","query":{"path":["JS","DOM操作"]},"buildId":"IPGLRe1nlocCv8hyBpTSS","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-ea0a66d28b40ad4ab0d2.js" async=""></script><script src="/_next/static/chunks/framework-d3984ef788efc6bd8157.js" async=""></script><script src="/_next/static/chunks/597-9d03ea954e499bbdd7af.js" async=""></script><script src="/_next/static/chunks/778-1467ee0b708f5cd375c0.js" async=""></script><script src="/_next/static/chunks/main-9ca82ec4d4aca520c43d.js" async=""></script><script src="/_next/static/chunks/pages/_app-49d413833563c7b39a6e.js" async=""></script><script src="/_next/static/chunks/525-eaa095b223f3548a6266.js" async=""></script><script src="/_next/static/chunks/644-2d382948659572c3e3d0.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B...path%5D-53df0732a14e01452fa5.js" async=""></script><script src="/_next/static/IPGLRe1nlocCv8hyBpTSS/_buildManifest.js" async=""></script><script src="/_next/static/IPGLRe1nlocCv8hyBpTSS/_ssgManifest.js" async=""></script></body></html>