<!DOCTYPE html><html><head><link rel="icon" href="/favicon.ico"/><link rel="preload" href="//at.alicdn.com/t/font_2533274_yhzuq4j0hfr.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="stylesheet" href="//at.alicdn.com/t/font_2533274_yhzuq4j0hfr.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-1DXREC8Y53"></script><script>
              window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments)}
              gtag('js', new Date()); gtag('config', 'G-1DXREC8Y53');
            </script><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"/><meta name="keywords" content="yrobot,blog,博客,async,script,defer,浏览器,多个,处理"/><meta name="description" content="浏览器是怎么处理多个defer或async的script的"/><title>浏览器是怎么处理多个defer或async的script的</title><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/886f8c3411ad1c39be9a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/886f8c3411ad1c39be9a.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-728d319af5b79ac932e2.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework-d3984ef788efc6bd8157.js" as="script"/><link rel="preload" href="/_next/static/chunks/597-9d03ea954e499bbdd7af.js" as="script"/><link rel="preload" href="/_next/static/chunks/778-1467ee0b708f5cd375c0.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-9ca82ec4d4aca520c43d.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-49d413833563c7b39a6e.js" as="script"/><link rel="preload" href="/_next/static/chunks/525-eaa095b223f3548a6266.js" as="script"/><link rel="preload" href="/_next/static/chunks/644-2d382948659572c3e3d0.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5B...path%5D-20be8281364ff903a94a.js" as="script"/></head><body><div id="__next"><div class="mx-auto md:max-w-screen-lg 2xl:max-w-screen-2xl"><div class="md:flex flex-row items-start justify-between"><div class="card menu h-60px md:flex-none md:w-90px md:h-600px md:mr-20px 2xl:w-120px 2xl:h-850px 2xl: 2xl:mr-50px flex flex-row items-center justify-between md:flex-col mb-20px"><a class="iconfont iconlogo flex-none mr-auto ml-15px md:ml-0 md:mr-0 md:mt-20px md:mb-auto w-30px h-30px text-30px md:w-50px md:h-50px md:text-50px 2xl:w-60px 2xl:h-60px 2xl:text-60px"></a><a class="iconfont iconhome cursor-pointer flex-none w-20px h-20px text-20px mr-20px md:mr-0 md:mb-50px md:w-30px md:h-30px md:text-30px" href="/"></a><a class="iconfont icongithub cursor-pointer flex-none w-20px h-20px text-20px mr-20px md:mr-0 md:mb-50px md:w-30px md:h-30px md:text-30px" target="_blank" href="https://github.com/Yrobot"></a><a class="iconfont iconemail cursor-pointer flex-none w-20px h-20px text-20px  mr-20px md:mr-0 md:mb-50px md:w-30px md:h-30px md:text-30px" href="mailto:y_robot@yeah.net?subject="></a><a class="iconfont cursor-pointer flex-none w-20px h-20px text-20px mr-15px md:mr-0 md:mb-20px 2xl:mb-50px md:w-30px md:h-30px md:text-30px iconenglish"></a></div><div class="min-w-0 flex-auto 2xl:flex flex-row items-start justify-between"><div class="min-w-0 2xl:flex-auto 2xl:mr-50px 2xl:pt-30px"><div class="text-center text-xl mb-6px md:text-4xl md:font-bold md:mb-10px 2xl:text-5xl 2xl:mb-15px font-medium">浏览器是怎么处理多个defer或async的script的</div><div class="text-center whitespace-pre-wrap text-gray-500 font-light text-14px leading-20px md:text-16px mb-20px">2019-10-15  |  <!-- -->1<!-- -->分钟<!-- -->  |  yrobot  |  <span class="md:hidden">
</span>async,script,defer,浏览器,多个,处理</div><article class="prose prose-sm break-all md:prose 2xl:prose-lg mb-15px md:mb-20px"><p><a id='top'></a></p>
<ol>
<li><p>浏览器下载资源可以并行，但是有上限，不同浏览器的上限不同，但都是在8以内。具体参考：<a href="http://www.stevesouders.com/blog/2008/03/20/roundup-on-parallel-connections/">http://www.stevesouders.com/blog/2008/03/20/roundup-on-parallel-connections/</a></p>
</li>
<li><p>浏览器对于同一服务器下的资源可以利用HTTP/1.1的Keep alive，保持tcp层的连接，下个请求就无需再经过tcp连接，减少通信耗时，提高了同一服务器下资源的下载效率。</p>
</li>
<li><p>对于不同地址的资源浏览器还是得通过并行资源请求，而因为并行下载线程数量被控制在个位数，所以多个不同地的script势必会造成script下载的拥塞。</p>
</li>
</ol>
</article><div class="overflow-hidden flex flex-row items-center justify-between pt-10px md:pt-15px border-t-1px border-gray-200 mb-20px md:mb-40px"><span class="iconfont iconleft flex-none w-14px h-14px text-14px md:w-16px md:h-16px md:text-16px md:mr-4px"></span><a href="/blog/JS/探讨ESM对当前开发的意义或影响" class="flex-none w-40% text-14px leading-16px md:text-16px overflow-hidden whitespace-nowrap overflow-ellipsis">探讨ESM对当前开发的意义或影响</a><div class="mx-auto"></div><a href="/blog/HTML&amp;CSS/css层叠上下文" class="flex-none w-40% text-right text-14px leading-16px md:text-16px overflow-hidden whitespace-nowrap overflow-ellipsis">css层叠上下文</a><span class="iconfont iconright flex-none w-14px h-14px text-14px md:w-16px md:h-16px md:text-16px md:ml-4px"></span></div><div class="mb-20px"><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div id="vcomments"></div></div></div><div class="2xl:flex-none 2xl:w-580px"><div class="pt-24px md:pt-24px 2xl:pt-30px mb-15px md:mb-20px"><div class="relative card pl-20px flex flex-col items-start justify-center h-96px md:h-126px 2xl:h-160px pr-120px md:pr-170px 2xl:pr-195px"><div class="text-20px md:text-26px 2xl:text-36px font-bold mb-10px md:mb-15px 2xl:mb-15px">你好！我是Yrobot</div><div class="text-14px md:text-16px 2xl:text-16px">欢迎来到我的博客，希望你在这里玩得开心！</div><img class="h-120px md:h-150px 2xl:h-190px absolute bottom-0 right-20px" src="/assets/person.svg" alt="person"/></div></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot" target="_blank"><img src="https://github-readme-stats.vercel.app/api?count_private=true&amp;show_icons=true&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot/mina-touch" target="_blank"><img src="https://github-readme-stats.vercel.app/api/pin?repo=mina-touch&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot/react-mobile-table" target="_blank"><img src="https://github-readme-stats.vercel.app/api/pin?repo=react-mobile-table&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div><div class="card mb-15px md:mb-20px overflow-hidden"><a href="https://github.com/Yrobot/mina-popups" target="_blank"><img src="https://github-readme-stats.vercel.app/api/pin?repo=mina-popups&amp;username=yrobot&amp;title_color=000000&amp;icon_color=000000&amp;text_color=000000&amp;border_color=F4F4F5&amp;bg_color=F4F4F5" alt="GithubCard"/></a></div></div></div></div><footer class="bg-accent-1"></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"pre":{"path":"_blogs/JS/探讨ESM对当前开发的意义或影响/README.md","url":"/blog/JS/探讨ESM对当前开发的意义或影响","title":"探讨ESM对当前开发的意义或影响","author":"yrobot","keywords":"ESM,探讨,意义,当前,开发,影响","createTime":1571068800000,"length":1414,"content":"\u003cp\u003e\u003ca id='top'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e本页目录：\u003c/strong\u003e\u003cbr\u003e\u003ca href=\"#compare\"\u003e对比当前模块开发和ES6模块化开发\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#ESMinit\"\u003eESM init 优化方案\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#All\"\u003e总的来说\u003c/a\u003e  \u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003e友情连接：\u003c/strong\u003e\u003cbr\u003eQ：浏览器遇到多个script资源的时候是怎么做的呢？\u003cbr\u003eA：\u003ca href=\"../%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E6%80%8E%E4%B9%88%E5%A4%84%E7%90%86%E5%A4%9A%E4%B8%AAdefer%E6%88%96async%E7%9A%84script%E7%9A%84\"\u003e浏览器是怎么处理多个defer或async的script的\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca id='compare'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"对比当前模块开发和es6模块化开发\"\u003e对比当前模块开发和ES6模块化开发\u003c/h2\u003e\n\u003ch4 id=\"开发方式对比\"\u003e开发方式对比\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003ecommonjs的模块化流程：  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e利用commonjs的模块规范进行引入使用，而npm大部分包也是用的commonjs规范写的。前端为了解决浏览器不支持commonjs模块，利用webpack等打包工具，将模块打包到一个js文件中，最后引入html。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ees6模块化开发流程：  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e保证所有依赖支持es6的模块化规范，在html利用type=“module”来引入根js（cdn的js只能使用script引入）\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"资源加载对比\"\u003e资源加载对比\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cp\u003ecommonjs的模块化：  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e原来的js文件被整合到一个js文件中，请求网页时，对于这些js只需发送一个script请求即可，只是这个js文件比较大。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003ees6模块化开发：  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e对于es6模块，浏览器解析到\u003ccode\u003e\u0026lt;script type=\u0026quot;module\u0026quot; src=\u0026quot;..\u0026quot;/\u0026gt;\u003c/code\u003e时，因为type=\u0026quot;module\u0026quot;的script默认defer，所以页面会继续解析渲染不受js下载执行阻塞，但是对于依赖，浏览器只能在解析js的步骤中获取依赖然后进行请求下载，依赖下载运行后才能继续执行。\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca id='ESMinit'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"esm-init-优化方案\"\u003eESM init 优化方案\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e当然通过服务器在请求页面时主动将依赖js一起传给浏览器来直接减少请求数量，但是这就需要服务器知道项目依赖关系，这超出了一些静态文件服务器的职能范围了。  \u003c/li\u003e\n\u003cli\u003e或者服务器将依赖关系网传给浏览器，让浏览器解析当前需要的js依赖，一次性向服务器请求完，而且因为http1.1的keep alivia的存在会让项目init js的时间比单纯原生请求要少去 \u003cstrong\u003e1.一步步解析js获取依赖再请求依赖的时间\u003c/strong\u003e 以及 __2.浏览器多次和服务器tcp连接的时间__，但是需要维护依赖关系网作为牺牲。\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca id='All'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"总的来说\"\u003e总的来说\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e对于一些大项目，势必会用到打包工具进行优化（代码压缩，label，eslint），然而es6原生模块支持即使在良好的关系网维护以及浏览器预解析关系网并预加载依赖的最好情况下，加载时间也不比commonjs打包成一整个js文件快多少。但是维护依赖关系网这件事也并不轻松。所以大项目使用ESM的意义目前来看并不是很大。  \u003c/li\u003e\n\u003cli\u003e但是对于一些小项目，总共js依赖文件没多少的那种，使用webpack这种臃肿的大包工具并不会对项目起到多大的优化作用，那么何尝不试试直接使用ESM，开发静态网页的快感谁试谁知道，所以出现了将commonjs模块标准转换成ESM的工具\u003ca href=\"https://github.com/pikapkg/web\"\u003e@pika/web\u003c/a\u003e。\u003c/li\u003e\n\u003c/ol\u003e\n"},"blog":{"path":"_blogs/JS/浏览器是怎么处理多个defer或async的script的/README.md","url":"/blog/JS/浏览器是怎么处理多个defer或async的script的","title":"浏览器是怎么处理多个defer或async的script的","author":"yrobot","keywords":"async,script,defer,浏览器,多个,处理","createTime":1571068800000,"length":315,"content":"\u003cp\u003e\u003ca id='top'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e浏览器下载资源可以并行，但是有上限，不同浏览器的上限不同，但都是在8以内。具体参考：\u003ca href=\"http://www.stevesouders.com/blog/2008/03/20/roundup-on-parallel-connections/\"\u003ehttp://www.stevesouders.com/blog/2008/03/20/roundup-on-parallel-connections/\u003c/a\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e浏览器对于同一服务器下的资源可以利用HTTP/1.1的Keep alive，保持tcp层的连接，下个请求就无需再经过tcp连接，减少通信耗时，提高了同一服务器下资源的下载效率。\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e对于不同地址的资源浏览器还是得通过并行资源请求，而因为并行下载线程数量被控制在个位数，所以多个不同地的script势必会造成script下载的拥塞。\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n"},"next":{"path":"_blogs/HTML\u0026CSS/css层叠上下文/README.md","url":"/blog/HTML\u0026CSS/css层叠上下文","title":"css层叠上下文","author":"yrobot","keywords":"css,层叠,上下文","createTime":1568649600000,"length":1371,"content":"\u003cp\u003e\u003cstrong\u003e本页目录：\u003c/strong\u003e\u003cbr\u003e\u003ca href=\"#question\"\u003e元素之间有重叠，浏览器要怎么展示呢\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#how\"\u003e怎么确定元素层叠关系\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#sxw\"\u003e层叠上下文\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#xdsx\"\u003e层叠顺序\u003c/a\u003e\u003cbr\u003e\u003ca href=\"#doit\"\u003e实操一下看\u003c/a\u003e  \u003c/p\u003e\n\u003cp\u003e\u003ca id='question'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"元素之间有重叠，浏览器要怎么展示呢\"\u003e元素之间有重叠，浏览器要怎么展示呢\u003c/h2\u003e\n\u003cp\u003e  当我们在编写html+css时，常常会遇到元素覆盖的问题，那解释器是怎么解释元素的覆盖的呢？  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e首先我们比确定的是，相邻的普通元素，都是后者覆盖前者的  \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e  但是对于相对较远的元素，拥有其他css属性（例如z-index）的属性呢？  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eemmmm，z-index值越大就越靠上？？ \u003c/li\u003e\n\u003cli\u003enono，解释器不是这么简单粗暴的  \u003c/li\u003e\n\u003cli\u003e下面我们就来探讨一下 层叠上下文 对元素 层叠关系的影响   \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003ca id='how'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"怎么确定元素层叠关系\"\u003e怎么确定元素层叠关系\u003c/h2\u003e\n\u003cp\u003e前端页面元素的覆盖关系由 \u003cstrong\u003e所属的层叠上下文\u003c/strong\u003e 和 \u003cstrong\u003e元素本身的层叠顺序\u003c/strong\u003e 决定  \u003c/p\u003e\n\u003cp\u003e先看层叠上下文，再看层叠顺序  \u003c/p\u003e\n\u003cp\u003e\u003ca id='sxw'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"层叠上下文\"\u003e层叠上下文\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\u003cp\u003e层叠上下文是页面元素的一种属性，页面由普通元素组成，一些元素因为种种原因而带有了层叠上下文  \u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e产生层叠上下文的种种原因：  \u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e页面根元素html天生具有层叠上下文，称之为“根层叠上下文”\u003c/li\u003e\n\u003cli\u003e普通元素满足以下条件时具有层叠上下文：a.position值非static  b.z-index值非auto\u003c/li\u003e\n\u003cli\u003eCSS3中的新属性也可以产生层叠上下文\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e所有元素的层叠关系都是相对于 最近父层叠上下文元素 来说的   \u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003ca id='xdsx'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"层叠顺序\"\u003e层叠顺序\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e层叠关系要在同一个层叠上下文中比较，两元素不在同一个层叠上下文则向上寻找，直到同一个层叠上下文，比较 \u003ccode\u003e最开始包含自己的层叠上下文（若有）|| 元素本身\u003c/code\u003e   \u003c/li\u003e\n\u003cli\u003e当将两者提升到同一个层叠上下文后，根据下图层叠顺序图来判断层叠关系 \u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e逻辑图如下：\u003cbr\u003e\u003cimg src=\"https://tva1.sinaimg.cn/large/006y8mN6ly1g72kli5irwj30hg08pmyl.jpg\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca id='doit'\u003e\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"实操一下看\"\u003e实操一下看\u003c/h2\u003e\n\u003cp\u003e\u003cimg src=\"https://tva1.sinaimg.cn/large/006y8mN6ly1g72kpdobofj30x70guacd.jpg\" alt=\"\"\u003e  \u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e建议判断层叠关系时，都在脑海中画一下上图虚拟DOM树  \u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e比较下以下几个元素的覆盖关系：\u003cbr\u003eB5-C3\u003cbr\u003eB2-B5\u003cbr\u003eC1-C2\u003cbr\u003eC3-B5\u003cbr\u003eC1-B1   \u003c/p\u003e\n\u003cp\u003e根据\u003ca href=\"#how\"\u003e怎么确定元素层叠关系\u003c/a\u003e，先看层叠上下文，再看层叠顺序  \u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e看层叠上下文  \u003cpre\u003e\u003ccode\u003eB5-C3 =\u0026gt; A4-A3   \nB2-B5 =\u0026gt; B2-A4   \nC1-C2 =\u0026gt; A1-B3   \nC3-B5 =\u0026gt; B4-B5   \nC1-B1 =\u0026gt; C1-B1   \n\u003c/code\u003e\u003c/pre\u003e\n\u003c/li\u003e\n\u003cli\u003e再根据\u003ca href=\"#xdsx\"\u003e层叠顺序\u003c/a\u003e的规则去判断元素的层叠关系吧！！！\u003c/li\u003e\n\u003c/ol\u003e\n"}},"__N_SSG":true},"page":"/blog/[...path]","query":{"path":["JS","浏览器是怎么处理多个defer或async的script的"]},"buildId":"otO-Pblm28jWfWVzwQNsm","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-728d319af5b79ac932e2.js" async=""></script><script src="/_next/static/chunks/framework-d3984ef788efc6bd8157.js" async=""></script><script src="/_next/static/chunks/597-9d03ea954e499bbdd7af.js" async=""></script><script src="/_next/static/chunks/778-1467ee0b708f5cd375c0.js" async=""></script><script src="/_next/static/chunks/main-9ca82ec4d4aca520c43d.js" async=""></script><script src="/_next/static/chunks/pages/_app-49d413833563c7b39a6e.js" async=""></script><script src="/_next/static/chunks/525-eaa095b223f3548a6266.js" async=""></script><script src="/_next/static/chunks/644-2d382948659572c3e3d0.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5B...path%5D-20be8281364ff903a94a.js" async=""></script><script src="/_next/static/otO-Pblm28jWfWVzwQNsm/_buildManifest.js" async=""></script><script src="/_next/static/otO-Pblm28jWfWVzwQNsm/_ssgManifest.js" async=""></script></body></html>